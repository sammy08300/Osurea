<!DOCTYPE html>
<html class="loading">
<head>
    <!-- Meta tags -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Osu!rea - Visualiseur d'area pour les joueurs d'osu! Configurez et visualisez votre zone active prÃ©cisÃ©ment, sauvegardez vos configurations dans des favoris et partagez-les.">
    <meta name="keywords" content="osu, tablet, area, zone active, visualiseur, tablette graphique, wacom, xp-pen, huion, gaomon">
    <meta name="author" content="Yuzuctus">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Osu!rea">
    <meta name="theme-color" content="#4287f5">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <meta property="og:title" content="Osu!rea - Area Visualizer">
    <meta property="og:description" content="Visualiseur de zone active pour les joueurs d'osu!. Configurez et partagez vos zones actives facilement.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://areasu.netlify.app/">
    <meta name="google-site-verification" content="TaES03KbkWLutAmQcc_QLwMWPLjYTguUHQoTviS0PAQ" />

    <title>Osu!rea - Area Visualizer</title>
    <link rel="icon" href="assets/img/favicon.svg" type="image/svg+xml">
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="preload" href="assets/img/favicon.svg" as="image" fetchpriority="high">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preload" href="assets/css/styles.css" as="style" fetchpriority="high">
    <link rel="stylesheet" href="assets/css/styles.css">

    <style>
        .custom-checkbox:checked ~ .checkbox-indicator { transform: scale(1); }
        .checkbox-indicator { transform: scale(0); transition: transform 0.25s ease-out; }
        .ratio-editable, .ratio-locked { background-color: #161824; color: #ffffff; }
        .lazy-image { opacity: 0; transition: opacity 0.3s ease-in-out; }
        .lazy-image.loaded { opacity: 1; }
        .locale-option { transition: background-color 0.2s ease-in-out; }
        main { opacity: 0; transition: opacity 0.25s ease-out; }
        body.page-loaded main { opacity: 1; }
        body.page-loaded .fade-in-sequence > * { opacity: 0; transform: translateY(4px); animation: fadeInUp 0.25s forwards; }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
    </style>

    <script type="module" src="assets/js/init/backgroundAndPrefetch.js"></script>
</head>
<body class="dark text-gray-200 font-sans antialiased min-h-screen loading">
    <!-- Header (Portfolio Style) -->
    <header class="site-header">
        <div class="container">
            <div class="header-container">
                <!-- Logo and Title -->
                <div class="logo-container">
                    <h1>
                        <span class="osu">Osu!</span><span class="yuzu">rea</span>
                    </h1>
                    <p class="subtitle" data-i18n="app.title">Area Visualizer</p>
                </div>
                
                <!-- Navigation and Language Selector -->
                <div class="flex items-center space-x-6">
                    <!-- Language Selector -->
                    <div id="locale-switcher" class="relative" style="visibility:hidden; opacity:0; transition:opacity 0.3s ease-out;">
                        <button id="locale-button" class="flex items-center space-x-2 px-4 py-2 rounded-lg hover:bg-white/10 transition-all">
                            <span id="selected-locale-text"></span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div id="locale-dropdown" class="absolute right-0 mt-2 bg-gray-800 rounded-lg shadow-xl z-20 w-full overflow-hidden hidden">
                            <!-- Language options will be inserted here by the script -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Script pour lazy loading des images -->
    <script type="module">
        import { setupLazyLoadListeners } from './assets/js/utils/lazyLoadImages.js';
        document.addEventListener('DOMContentLoaded', setupLazyLoadListeners);
    </script>

    <!-- Main Content with Compact Layout -->
    <main class="pt-8 pb-4" style="margin-top: 80px;">
        <div class="container mx-auto px-4 fade-in-sequence">
            <!-- Main Grid Layout - Full Width -->
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                <!-- Left Sidebar: Configuration -->
                <div class="lg:col-span-4 space-y-4">
                    <!-- Tablet Settings Card -->
                    <div class="glass-card floating-card rounded-xl p-4">
                        <div class="section-header">
                            <h3 class="text-white" data-i18n="tablet.settings">
                                <div class="icon-container bg-gradient-to-r from-blue-500 to-purple-600">
                                    <i class="fas fa-tablet-alt text-white"></i>
                                </div>
                                Tablet Settings
                            </h3>
                        </div>
                        
                        <div class="space-y-6">
                            <!-- Tablet Model Selector -->
                            <div class="space-y-3">
                                <label class="block text-sm font-medium text-gray-300" data-i18n="tablet.model">
                                    Tablet Model
                                </label>
                                <div class="tablet-selector-container relative">
                                    <button id="tabletSelectorButton" type="button" class="w-full glass-card rounded-lg h-12 px-4 text-left text-gray-100 hover:bg-white/10 transition-all flex items-center justify-between">
                                        <span id="tabletSelectorText" class="truncate block max-w-[calc(100%-24px)]"></span>
                                        <i class="fas fa-chevron-down text-gray-400"></i>
                                    </button>
                                    <div id="tabletSelectorPopup" class="glass-card rounded-lg shadow-xl overflow-hidden hidden">
                                        <div class="flex flex-col h-[70vh] max-h-[600px] min-h-[500px]">
                                            <!-- Search bar - FULL WIDTH AT TOP -->
                                            <div class="p-4 border-b border-gray-700 flex-shrink-0">
                                                <div class="relative">
                                                    <input type="text" id="tabletSearch" placeholder="Search tablet..." class="w-full glass-card rounded-lg p-3 pl-10 text-gray-100 placeholder-gray-400" data-i18n="tablet.searchTablet">
                                                    <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                                </div>
                                            </div>
                                            
                                            <!-- Main container: Brands and Models side by side (SCROLLABLE) -->
                                            <div class="flex flex-1 overflow-hidden">
                                                <!-- Left column: Brands (SCROLLABLE) -->
                                                <div class="w-1/2 border-r border-gray-700">
                                                    <div id="tabletBrandsList" class="h-full overflow-y-auto custom-scrollbar">
                                                        <!-- Brands inserted dynamically -->
                                                    </div>
                                                </div>
                                                
                                                <!-- Right column: Models (SCROLLABLE) -->
                                                <div class="w-1/2">
                                                    <div id="tabletModelsList" class="h-full overflow-y-auto custom-scrollbar">
                                                        <!-- Models inserted dynamically -->
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Custom dimensions button - FULL WIDTH AT BOTTOM (ALWAYS VISIBLE) -->
                                            <div class="border-t border-gray-700 w-full flex-shrink-0">
                                                <button id="customTabletButton" type="button" class="flex items-center justify-center gap-3 py-4 w-full text-center hover:bg-blue-600/20 bg-gray-800/30 text-white font-medium transition-all">
                                                    <i class="fas fa-plus"></i>
                                                    <span data-i18n="tablet.customDimensions">Custom Dimensions</span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Tablet Dimensions -->
                            <div id="tablet-dimensions-container" class="hidden space-y-4">
                                <div class="grid grid-cols-2 gap-4">
                                    <div id="tablet-width-group">
                                        <label for="tabletWidth" class="block text-sm font-medium text-gray-300 mb-2" data-i18n="tablet.width">
                                            Tablet Width
                                        </label>
                                        <div class="relative">
                                            <input type="number" id="tabletWidth" value="152.0" min="10" max="2000" step="0.1" class="w-full glass-card rounded-lg p-3 pr-12 text-gray-100 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                                            <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm" data-i18n="tablet.units">mm</span>
                                        </div>
                                    </div>
                                    <div id="tablet-height-group">
                                        <label for="tabletHeight" class="block text-sm font-medium text-gray-300 mb-2" data-i18n="tablet.height">
                                            Tablet Height
                                        </label>
                                        <div class="relative">
                                            <input type="number" id="tabletHeight" value="95.0" min="10" max="2000" step="0.1" class="w-full glass-card rounded-lg p-3 pr-12 text-gray-100 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                                            <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm" data-i18n="tablet.units">mm</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Area Configuration Card -->
                    <div class="glass-card floating-card rounded-xl p-4">
                        <div class="section-header">
                            <h3 class="text-white" data-i18n="area.settings">
                                <div class="icon-container bg-gradient-to-r from-purple-500 to-pink-600">
                                    <i class="fas fa-crop-alt text-white"></i>
                                </div>
                                Area Configuration
                            </h3>
                        </div>
                        
                        <div class="space-y-6">
                            <!-- Ratio -->
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="customRatio" class="block text-sm font-medium text-gray-300 mb-2" data-i18n="area.ratio">
                                        Ratio (W/H)
                                    </label>
                                    <input type="number" id="customRatio" value="1.000" min="0.001" max="10" step="0.001" class="w-full glass-card rounded-lg p-3 text-gray-100 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Lock Ratio</label>
                                    <div class="flex items-center h-12">
                                        <button id="lockRatio" 
                                                type="button" 
                                                class="w-6 h-6 glass-card rounded-md hover:bg-white/10 relative" 
                                                aria-pressed="true"
                                                onclick="toggleLockRatio(this)">
                                            <div id="lockRatioIndicator" class="absolute inset-0 flex items-center justify-center pointer-events-none">
                                                <div class="w-3 h-3 bg-blue-500 rounded-sm transform scale-100 transition-transform duration-200 ease-out origin-center"></div>
                                            </div>
                                        </button>
                                        <span class="ml-3 text-sm font-medium text-gray-300" data-i18n="area.lockRatio">Lock ratio</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Dimensions -->
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="areaWidth" class="block text-sm font-medium text-gray-300 mb-2" data-i18n="area.width">
                                        Area Width
                                    </label>
                                    <div class="relative">
                                        <input type="number" id="areaWidth" value="75.0" min="1" max="1000" step="0.1" class="w-full glass-card rounded-lg p-3 pr-12 text-gray-100 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm" data-i18n="tablet.units">mm</span>
                                    </div>
                                </div>
                                <div>
                                    <label for="areaHeight" class="block text-sm font-medium text-gray-300 mb-2" data-i18n="area.height">
                                        Area Height
                                    </label>
                                    <div class="relative">
                                        <input type="number" id="areaHeight" value="75.0" min="1" max="1000" step="0.1" class="w-full glass-card rounded-lg p-3 pr-12 text-gray-100 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm" data-i18n="tablet.units">mm</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Position -->
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="areaOffsetX" class="block text-sm font-medium text-gray-300 mb-2" data-i18n="area.positionX">
                                        Offset X
                                    </label>
                                    <div class="relative">
                                        <input type="number" id="areaOffsetX" value="76.000" step="0.001" class="w-full glass-card rounded-lg p-3 pr-12 text-gray-100 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm" data-i18n="tablet.units">mm</span>
                                    </div>
                                </div>
                                
                                <div>
                                    <label for="areaOffsetY" class="block text-sm font-medium text-gray-300 mb-2" data-i18n="area.positionY">
                                        Offset Y
                                    </label>
                                    <div class="relative">
                                        <input type="number" id="areaOffsetY" value="47.500" step="0.001" class="w-full glass-card rounded-lg p-3 pr-12 text-gray-100 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm" data-i18n="tablet.units">mm</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Rectangle Radius -->
                            <div id="radius-control-group" class="space-y-4">
                                <div>
                                    <label for="areaRadius" class="block text-sm font-medium text-gray-300 mb-2" data-i18n="area.radius">
                                        Corner Radius
                                    </label>
                                    <div class="flex items-center gap-4">
                                        <input type="range" id="areaRadius" min="0" max="100" value="0" class="flex-1 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                        <div class="relative w-20">
                                            <input type="number" id="radius-input" value="0" min="0" max="100" class="w-full glass-card rounded-lg p-2 pr-8 text-right text-gray-100 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                                            <span class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm">%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="grid grid-cols-2 gap-3">
                                <button id="swap-btn" class="bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white font-medium rounded-lg py-3 px-4 flex items-center justify-center transition-all">
                                    <i class="fas fa-exchange-alt mr-2"></i>
                                    <span data-i18n="area.swap">Swap</span>
                                </button>
                                <button id="center-btn" class="bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white font-medium rounded-lg py-3 px-4 flex items-center justify-center transition-all">
                                    <i class="fas fa-crosshairs mr-2"></i>
                                    <span data-i18n="area.center">Center</span>
                                </button>
                            </div>

                            <div class="grid grid-cols-2 gap-3">
                                <button id="copy-btn" class="bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white font-medium rounded-lg py-3 px-4 flex items-center justify-center transition-all">
                                    <i class="fas fa-copy mr-2"></i>
                                    <span data-i18n="summary.copyInfo">Copy Info</span>
                                </button>
                                <button id="save-btn" class="bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white font-medium rounded-lg py-3 px-4 flex items-center justify-center transition-all">
                                    <i class="fas fa-save mr-2"></i>
                                    <span data-i18n="favorites.saveButton">Save</span>
                                </button>
                            </div>
                            
                            <button id="cancel-edit-btn" class="hidden w-full bg-gradient-to-r from-rose-500 to-red-600 hover:from-rose-600 hover:to-red-700 text-white font-medium rounded-lg py-3 px-4 flex items-center justify-center transition-all">
                                <i class="fas fa-times mr-2"></i>
                                <span data-i18n="favorites.cancelButton">Cancel Edit</span>
                            </button>
                        </div>
                    </div>

                </div>

                <!-- Right Side: Visualization and Favorites -->
                <div class="lg:col-span-8 space-y-4">
                    <!-- Visualization Card -->
                    <div class="glass-card floating-card rounded-xl p-4">
                        <div class="flex justify-between items-center mb-4">
                            <div class="section-header">
                                <h3 class="text-white" data-i18n="visual.visualization">
                                    <div class="icon-container bg-gradient-to-r from-pink-500 to-rose-600">
                                        <i class="fas fa-eye text-white"></i>
                                    </div>
                                    Visualization
                                </h3>
                            </div>
                            <div class="flex items-center">
                                <label for="toggleGridCheckbox" class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="toggleGridCheckbox" checked class="sr-only peer">
                                    <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-500 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    <span class="ml-3 text-sm font-medium text-gray-300" data-i18n="visual.showGrid">Show Grid</span>
                                </label>
                            </div>
                        </div>
                        
                        <div id="visual-container" class="w-full h-[450px] glass-card rounded-xl flex items-center justify-center overflow-hidden relative">
                            <!-- Loading overlay -->
                            <div id="loading-overlay" class="absolute inset-0 z-10 bg-gray-950/90 flex items-center justify-center">
                                <div class="loading-spinner">
                                    <svg class="w-12 h-12" viewBox="0 0 50 50">
                                        <circle class="spinner-track" cx="25" cy="25" r="20" fill="none" stroke-width="3"></circle>
                                        <circle class="spinner-circle" cx="25" cy="25" r="20" fill="none" stroke-width="3"></circle>
                                    </svg>
                                </div>
                            </div>
                            <div id="backgroundGrid" class="absolute inset-0 opacity-20" style="background-size: 20px 20px; background-image: linear-gradient(to right, rgb(75, 85, 99) 1px, transparent 1px), linear-gradient(to bottom, rgb(75, 85, 99) 1px, transparent 1px);"></div>
                            <div id="tablet-boundary" class="relative border-2 border-gray-600 rounded bg-gray-800/30">
                                <div id="rectangle" class="absolute bg-blue-500/40 border-2 border-blue-500 rounded invisible neon-accent"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Favorites Card -->
                    <div class="glass-card floating-card rounded-xl p-4">
                        <div class="flex justify-between items-center mb-4">
                            <div class="section-header">
                                <h3 class="text-white" data-i18n="favorites.title">
                                    <div class="icon-container bg-gradient-to-r from-yellow-500 to-orange-600">
                                        <i class="fas fa-star text-white"></i>
                                    </div>
                                    Favorites
                                </h3>
                            </div>
                            <div id="sort-options" class="flex space-x-2">
                                <button data-sort="date" class="sort-button py-2 px-3 text-xs rounded-lg font-medium text-gray-300 glass-card hover:bg-white/10 transition-all" data-i18n="favorites.sortDate">Date</button>
                                <button data-sort="name" class="sort-button py-2 px-3 text-xs rounded-lg font-medium text-gray-300 glass-card hover:bg-white/10 transition-all" data-i18n="favorites.sortName">Name</button>
                                <button data-sort="size" class="sort-button py-2 px-3 text-xs rounded-lg font-medium text-gray-300 glass-card hover:bg-white/10 transition-all" data-i18n="favorites.sortSize">Size</button>
                                <button data-sort="modified" class="sort-button py-2 px-3 text-xs rounded-lg font-medium text-gray-300 glass-card hover:bg-white/10 transition-all" data-i18n="favorites.sortModified">Modified</button>
                            </div>
                        </div>

                        <div id="favorites-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 max-h-80 overflow-y-auto pr-2 custom-scrollbar">
                            <div class="col-span-full text-center py-8">
                                <i class="fas fa-heart text-4xl text-gray-600 mb-3"></i>
                                <p class="text-gray-400 italic" data-i18n="favorites.noFavorites">No favorites saved yet. Save a configuration to find it here.</p>
                            </div>
                            <!-- Favorites will be inserted here dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Container for delayed footer -->
    <div id="footer-container" style="opacity: 0; transition: opacity 0.4s ease-out;"></div>

    <!-- Footer and loading script -->
    <script type="module" src="assets/js/components/ui/footer.js"></script>

    <!-- Context Menu -->
    <div id="context-menu" class="fixed hidden">
        <div class="context-menu-title" data-i18n="alignment.title">
            <i class="fas fa-crosshairs"></i>
            Area Positioning
        </div>
        <div class="context-menu-grid">
            <!-- Top row -->
            <button id="align-top-left">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5">
                    <rect width="18" height="18" x="3" y="3" rx="2"/>
                    <path d="M8 8L16 16"/>
                    <path d="M8 16V8H16"/>
                </svg>
            </button>
            <button id="align-top">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="18" height="18" x="3" y="3" rx="2"/>
                    <path d="m16 12-4-4-4 4"/>
                    <path d="M12 16V8"/>
                </svg>
            </button>
            <button id="align-top-right">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="18" height="18" x="3" y="3" rx="2"/>
                    <path d="M8 8h8v8"/>
                    <path d="m8 16 8-8"/>
                </svg>
            </button>
            
            <!-- Middle row -->
            <button id="align-left">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="18" height="18" x="3" y="3" rx="2"/>
                    <path d="m12 8-4 4 4 4"/>
                    <path d="M16 12H8"/>
                </svg>
            </button>
            <button id="align-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="18" height="18" x="3" y="3" rx="2"/>
                    <circle cx="12" cy="12" r="3"/>
                    <line x1="12" y1="5" x2="12" y2="9"/>
                    <line x1="12" y1="15" x2="12" y2="19"/>
                    <line x1="5" y1="12" x2="9" y2="12"/>
                    <line x1="15" y1="12" x2="19" y2="12"/>
                </svg>
            </button>
            <button id="align-right">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="18" height="18" x="3" y="3" rx="2"/>
                    <path d="m12 16 4-4-4-4"/>
                    <path d="M8 12h8"/>
                </svg>
            </button>
            
            <!-- Bottom row -->
            <button id="align-bottom-left">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="18" height="18" x="3" y="3" rx="2"/>
                    <path d="M8 8v8h8"/>
                    <path d="M8 16l8-8"/>
                </svg>
            </button>
            <button id="align-bottom">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="18" height="18" x="3" y="3" rx="2"/>
                    <path d="m8 12 4 4 4-4"/>
                    <path d="M12 8v8"/>
                </svg>
            </button>
            <button id="align-bottom-right">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="18" height="18" x="3" y="3" rx="2"/>
                    <path d="M16 8v8h-8"/>
                    <path d="M16 16l-8-8"/>
                </svg>
            </button>
        </div>
    </div>
    
    <!-- Container for notifications -->
    <div id="notification-container" class="fixed bottom-4 right-4 z-50 space-y-2 pointer-events-none">
        <!-- Notifications will be added here dynamically -->
    </div>

    <!-- SCRIPTS EN FIN DE BODY -->
    <script type="module" src="assets/locales/index.js" defer></script>
    <script type="module" defer>
        import initializeI18n from './assets/js/i18n-init.js';
        document.addEventListener('DOMContentLoaded', initializeI18n);
    </script>
    <script type="module" src="assets/js/locale-switcher.js" defer></script>

    <script type="module" src="assets/js/utils/storage.js" defer></script>
    <script src="assets/js/utils/preferences.js" defer></script>
    <script src="assets/js/utils/constraintHelpers.js" defer></script>
    <script src="assets/js/components/area/contextMenu.js" defer></script>
    <script src="assets/js/components/ui/notifications.js" defer></script>
    <script src="assets/js/components/area/visualizer.js" defer></script>
    <script type="module" src="assets/js/components/favorites/favoritesModule.js" defer></script>
    <script type="module">
        import { toggleLockRatio } from './assets/js/components/ui/toggleLockRatio.js';
        document.addEventListener('DOMContentLoaded', () => {
            const btn = document.getElementById('lockRatio');
            if (btn) {
                btn.onclick = function() { toggleLockRatio(this); };
            }
        });
    </script>
    <script type="module" src="assets/js/app.js"></script>
    <script type="module" src="assets/js/init/rectangleInit.js"></script>
    <script type="module" src="assets/js/init/serviceWorkerRegister.js"></script>

    
    <!-- Test Loader - Load tests for development/debugging -->
    <script type="module" src="assets/js/tests/test-loader.js" defer></script>
    
    <!-- Range Slider Progress Script -->
    <script>
        function initializeSliderProgress() {
            const rangeSlider = document.getElementById('areaRadius');
            
            function updateSliderProgress() {
                if (!rangeSlider) return;
                const value = rangeSlider.value;
                const max = rangeSlider.max;
                const percentage = (value / max) * 100;
                rangeSlider.style.setProperty('--range-progress', percentage + '%');
            }
            
            // Rendre la fonction globalement accessible
            window.updateSliderProgress = updateSliderProgress;
            
            if (rangeSlider) {
                rangeSlider.addEventListener('input', updateSliderProgress);
                updateSliderProgress(); // Initial call
                
                // Also update on window load and after a delay
                setTimeout(updateSliderProgress, 100);
                setTimeout(updateSliderProgress, 500);
            }
        }
        
        // Initialize immediately and on DOM ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeSliderProgress);
        } else {
            initializeSliderProgress();
        }
        
        // Also initialize on window load as fallback
        window.addEventListener('load', initializeSliderProgress);
    </script>
    
    <!-- Console Debug Commands -->
    <script>
        // Global function to check all dimensions and parameters
        window.checkDimensions = function() {
            console.group('ðŸŽ¯ OSUREA - Configuration Summary');
            
            // Get all input values
            const areaWidth = parseFloat(document.getElementById('areaWidth')?.value) || 0;
            const areaHeight = parseFloat(document.getElementById('areaHeight')?.value) || 0;
            const areaOffsetX = parseFloat(document.getElementById('areaOffsetX')?.value) || 0;
            const areaOffsetY = parseFloat(document.getElementById('areaOffsetY')?.value) || 0;
            const customRatio = parseFloat(document.getElementById('customRatio')?.value) || 0;
            const areaRadius = parseInt(document.getElementById('areaRadius')?.value) || 0;
            
            // Get tablet dimensions
            const tabletWidth = parseFloat(document.getElementById('tabletWidth')?.value) || 0;
            const tabletHeight = parseFloat(document.getElementById('tabletHeight')?.value) || 0;
            const tabletModel = document.getElementById('tabletSelectorText')?.textContent || 'Unknown';
            
            // Calculate derived values
            const areaSurface = areaWidth * areaHeight;
            const tabletRatio = tabletWidth > 0 && tabletHeight > 0 ? (tabletWidth / tabletHeight) : 0;
            const areaRatio = areaWidth > 0 && areaHeight > 0 ? (areaWidth / areaHeight) : 0;
            
            // Tablet Information
            console.group('ðŸ“± TABLET INFORMATION');
            console.log(`Model: ${tabletModel}`);
            console.log(`Dimensions: ${tabletWidth.toFixed(1)} Ã— ${tabletHeight.toFixed(1)} mm`);
            console.log(`Ratio: ${tabletRatio.toFixed(3)}`);
            console.log(`Surface: ${(tabletWidth * tabletHeight).toFixed(1)} mmÂ²`);
            console.groupEnd();
            
            // Active Area Information
            console.group('ðŸŽ¯ ACTIVE AREA');
            console.log(`Dimensions: ${areaWidth.toFixed(1)} Ã— ${areaHeight.toFixed(1)} mm`);
            console.log(`Position: X=${areaOffsetX.toFixed(3)} mm, Y=${areaOffsetY.toFixed(3)} mm`);
            console.log(`Ratio: ${areaRatio.toFixed(3)} (Custom: ${customRatio.toFixed(3)})`);
            console.log(`Corner Radius: ${areaRadius}%`);
            console.log(`Surface: ${areaSurface.toFixed(1)} mmÂ²`);
            console.groupEnd();
            
            // Coverage Analysis
            console.group('ðŸ“Š COVERAGE ANALYSIS');
            const coveragePercentage = tabletWidth > 0 && tabletHeight > 0 ? 
                ((areaSurface / (tabletWidth * tabletHeight)) * 100) : 0;
            console.log(`Area Coverage: ${coveragePercentage.toFixed(2)}% of tablet surface`);
            
            // Position analysis
            const centerX = tabletWidth / 2;
            const centerY = tabletHeight / 2;
            const offsetFromCenterX = Math.abs(areaOffsetX - centerX);
            const offsetFromCenterY = Math.abs(areaOffsetY - centerY);
            
            console.log(`Center Position: X=${centerX.toFixed(1)} mm, Y=${centerY.toFixed(1)} mm`);
            console.log(`Offset from Center: X=${offsetFromCenterX.toFixed(1)} mm, Y=${offsetFromCenterY.toFixed(1)} mm`);
            
            // Check if area fits within tablet bounds
            const areaLeft = areaOffsetX - (areaWidth / 2);
            const areaRight = areaOffsetX + (areaWidth / 2);
            const areaTop = areaOffsetY - (areaHeight / 2);
            const areaBottom = areaOffsetY + (areaHeight / 2);
            
            const fitsHorizontally = areaLeft >= 0 && areaRight <= tabletWidth;
            const fitsVertically = areaTop >= 0 && areaBottom <= tabletHeight;
            
            console.log(`Area Bounds: Left=${areaLeft.toFixed(1)}, Right=${areaRight.toFixed(1)}, Top=${areaTop.toFixed(1)}, Bottom=${areaBottom.toFixed(1)}`);
            console.log(`Fits within tablet: ${fitsHorizontally && fitsVertically ? 'âœ… YES' : 'âŒ NO'}`);
            
            if (!fitsHorizontally) {
                console.warn('âš ï¸ Area extends beyond tablet width!');
            }
            if (!fitsVertically) {
                console.warn('âš ï¸ Area extends beyond tablet height!');
            }
            console.groupEnd();
            
            // Performance Metrics
            console.group('âš¡ PERFORMANCE METRICS');
            const pixelDensity = 96; // Standard DPI
            const areaWidthPx = (areaWidth / 25.4) * pixelDensity;
            const areaHeightPx = (areaHeight / 25.4) * pixelDensity;
            
            console.log(`Area in pixels: ${areaWidthPx.toFixed(0)} Ã— ${areaHeightPx.toFixed(0)} px`);
            console.log(`Pixel density: ${pixelDensity} DPI`);
            
            // Sensitivity calculation (pixels per mm)
            const sensitivityX = areaWidthPx / areaWidth;
            const sensitivityY = areaHeightPx / areaHeight;
            
            console.log(`Sensitivity: X=${sensitivityX.toFixed(2)} px/mm, Y=${sensitivityY.toFixed(2)} px/mm`);
            console.groupEnd();
            
            console.groupEnd();
            
            // Return object for programmatic access
            return {
                tablet: {
                    model: tabletModel,
                    width: tabletWidth,
                    height: tabletHeight,
                    ratio: tabletRatio,
                    surface: tabletWidth * tabletHeight
                },
                area: {
                    width: areaWidth,
                    height: areaHeight,
                    x: areaOffsetX,
                    y: areaOffsetY,
                    ratio: areaRatio,
                    customRatio: customRatio,
                    radius: areaRadius,
                    surface: areaSurface
                },
                analysis: {
                    coverage: coveragePercentage,
                    fitsWithinTablet: fitsHorizontally && fitsVertically,
                    offsetFromCenter: { x: offsetFromCenterX, y: offsetFromCenterY },
                    bounds: { left: areaLeft, right: areaRight, top: areaTop, bottom: areaBottom }
                },
                performance: {
                    pixelWidth: areaWidthPx,
                    pixelHeight: areaHeightPx,
                    sensitivityX: sensitivityX,
                    sensitivityY: sensitivityY
                }
            };
        };
        
        // Shortcut function
        window.dims = window.checkDimensions;
        
        // Auto-register the command
        console.log('ðŸŽ¯ Osurea Debug Commands loaded!');
        console.log('ðŸ“ Use checkDimensions() or dims() to see current configuration');
        console.log('ðŸ’¡ Example: dims()');
        
        // Test function for tablet selector (temporary)
        window.testTabletSelector = function() {
            const button = document.getElementById('tabletSelectorButton');
            const popup = document.getElementById('tabletSelectorPopup');
            
            console.log('ðŸ”§ Tablet Selector Test:');
            console.log('Button found:', !!button);
            console.log('Popup found:', !!popup);
            
            if (popup) {
                console.log('Popup parent:', popup.parentNode?.className || 'No parent');
                console.log('Popup hidden:', popup.classList.contains('hidden'));
                console.log('Popup z-index:', window.getComputedStyle(popup).zIndex);
            }
            
            if (button) {
                console.log('Button position:', button.getBoundingClientRect());
            }
        };
        
        console.log('ðŸ§ª Use testTabletSelector() to debug the tablet selector');
    </script>
</body>
</html>